openapi: 3.0.3

info:
  title: Finance
  description: Criado para ser utilizado com carteira pessoal de investimentos
  version: 0.1.0

servers:
  - url: http://localhost:3000
    description: Desenvolvimento

schemes:
  - http
consumes:
  - application/json
produces:
  - application/json

tags:
  - name: Category
    description: Category namespace
  - name: Broker
    description: Broker namespace
  - name: Transaction
    description: Transaction namespace
  - name: Dividends
    description: Dividends namespace
  - name: System
    description: System namespace

paths:
  # System
  /system/healthcheck:
    get:
      tags:
        - System
      summary: Retorna o status da API.
      responses:
        200: # status code
          description: Retorna o status da API.
          content:
            application/json:
              schema:
                type: string
                example: "OK"
        500: # status code
          $ref: "#/components/responses/internal"

  /system/metrics:
    get:
      tags:
        - System
      summary: Retorna metricas da API.
      responses:
        200: # status code
          description: Retorna metricas da API.
          content:
            application/json:
              schema:
                type: string
        500: # status code
          $ref: "#/components/responses/internal"
   
  # Broker       
  /category:
    get:
      tags:
        - Category
      summary: Retorna a lista de categorias.
      parameters:
        - in: query
          name: sortBy
          description: Atributo de ordenação
          schema:
            type: string
            example: "name"
        - in: query
          name: orderBy
          description: Tipo de ordenação (asc | desc)
          schema:
            type: string
            example: "asc"
        - in: query
          name: limit
          description: Limite de itens retornados
          schema:
            type: string
            example: "10"
        - in: query
          name: search
          description: Filtro de pesquisa
          schema:
            type: string
            example: {"name":"ismael"}
      responses:
        200: # status code
          $ref: "#/components/responses/category"

    post:
      tags:
        - Category
      summary: Criação de categoria.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/category"
      responses:
        200: # status code
          description: Cadastro de categoria.
          content:
            application/json:
              schema:
                type: string
                example: "Categoria criada com sucesso!!!"
        400: # status code
          $ref: "#/components/responses/badRequest"
        500: # status code
          $ref: "#/components/responses/internal"

  /category/{id}:
    get:
      tags:
        - Category
      summary: Retorna uma categoria por ID.
      parameters:
        - in: path
          required: true
          name: id
          description: ID da categoria
          schema:
            type: string
            example: "1"
      responses:
        200: # status code
          description: Categoria.
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: number
                    example: 1
                  name:
                    type: string
                    example: "Raquel"
                  createdAt:
                    type: string
                    example: "2021-03-31 22:34:36.476"
                  updatedAt:
                    type: string
                    example: "2021-03-31 22:34:36.476"
        400: # status code
          $ref: "#/components/responses/badRequest"
        404: # status code
          $ref: "#/components/responses/notFound"
        500: # status code
          $ref: "#/components/responses/internal"

    put:
      tags:
        - Category
      summary: Atualiza uma categoria.
      parameters:
        - in: path
          required: true
          name: id
          description: ID da categoria
          schema:
            type: string
            example: "1"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/category"
      responses:
        200: # status code
          description: Retorna status.
          content:
            application/json:
              schema:
                type: string
                example: "Categoria atualizada com sucesso!!!"
        400: # status code
          $ref: "#/components/responses/badRequest"
        404: # status code
          $ref: "#/components/responses/notFound"
        500: # status code
          $ref: "#/components/responses/internal"

    delete:
      tags:
        - Category
      summary: Deleta uma categoria.
      parameters:
        - in: path
          required: true
          name: id
          description: ID da categoria
          schema:
            type: string
            example: "1"
      responses:
        204: # status code
          description: Categoria deletada com sucesso.
        400: # status code
          $ref: "#/components/responses/badRequest"
        404: # status code
          $ref: "#/components/responses/notFound"
        500: # status code
          $ref: "#/components/responses/internal"
  
  # Broker
  /broker:
    get:
      tags:
        - Broker
      summary: Retorna a lista de brokers.
      parameters:
        - in: query
          name: sortBy
          description: Atributo de ordenação
          schema:
            type: string
            example: "name"
        - in: query
          name: orderBy
          description: Tipo de ordenação (asc | desc)
          schema:
            type: string
            example: "asc"
        - in: query
          name: limit
          description: Limite de itens retornados
          schema:
            type: string
            example: "10"
        - in: query
          name: search
          description: Filtro de pesquisa
          schema:
            type: string
            example: {"name":"ismael"}
      responses:
        200: # status code
          $ref: "#/components/responses/broker"

    post:
      tags:
        - Broker
      summary: Criação de brokers.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/broker"
      responses:
        200: # status code
          description: Cadastro de brokers.
          content:
            application/json:
              schema:
                type: string
                example: "Broker criado com sucesso!!!"
        400: # status code
          $ref: "#/components/responses/badRequest"
        500: # status code
          $ref: "#/components/responses/internal"

  /broker/{id}:
    get:
      tags:
        - Broker
      summary: Retorna um broker por ID.
      parameters:
        - in: path
          required: true
          name: id
          description: ID do broker
          schema:
            type: string
            example: "1"
      responses:
        200: # status code
          description: Broker.
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: number
                    example: 1
                  name:
                    type: string
                    example: "Raquel"
                  createdAt:
                    type: string
                    example: "2021-03-31 22:34:36.476"
                  updatedAt:
                    type: string
                    example: "2021-03-31 22:34:36.476"
        400: # status code
          $ref: "#/components/responses/badRequest"
        404: # status code
          $ref: "#/components/responses/notFound"
        500: # status code
          $ref: "#/components/responses/internal"

    put:
      tags:
        - Broker
      summary: Atualiza um broker.
      parameters:
        - in: path
          required: true
          name: id
          description: ID do broker
          schema:
            type: string
            example: "1"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/broker"
      responses:
        200: # status code
          description: Retorna status.
          content:
            application/json:
              schema:
                type: string
                example: "Broker atualizado com sucesso!!!"
        400: # status code
          $ref: "#/components/responses/badRequest"
        404: # status code
          $ref: "#/components/responses/notFound"
        500: # status code
          $ref: "#/components/responses/internal"

    delete:
      tags:
        - Broker
      summary: Deleta um broker.
      parameters:
        - in: path
          required: true
          name: id
          description: ID do broker
          schema:
            type: string
            example: "1"
      responses:
        204: # status code
          description: Broker deletado com sucesso.
        400: # status code
          $ref: "#/components/responses/badRequest"
        404: # status code
          $ref: "#/components/responses/notFound"
        500: # status code
          $ref: "#/components/responses/internal"

  # Transaction
  /transaction:
    get:
      tags:
        - Transaction
      summary: Retorna a lista de transações.
      parameters:
        - in: query
          name: sortBy
          description: Atributo de ordenação
          schema:
            type: string
            example: "name"
        - in: query
          name: orderBy
          description: Tipo de ordenação (asc | desc)
          schema:
            type: string
            example: "asc"
        - in: query
          name: limit
          description: Limite de itens retornados
          schema:
            type: string
            example: "10"
        - in: query
          name: search
          description: Filtro de pesquisa
          schema:
            type: string
            example: {"name":"ismael"}
      responses:
        200: # status code
          $ref: "#/components/responses/transaction"

    post:
      tags:
        - Transaction
      summary: Criação de transação.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/transaction"
      responses:
        200: # status code
          description: Cadastro de transação.
          content:
            application/json:
              schema:
                type: string
                example: "Transação criada com sucesso!!!"
        400: # status code
          $ref: "#/components/responses/badRequest"
        500: # status code
          $ref: "#/components/responses/internal"

  /transaction/{id}:
    get:
      tags:
        - Transaction
      summary: Retorna uma transação por ID.
      parameters:
        - in: path
          required: true
          name: id
          description: ID da transação
          schema:
            type: string
            example: "1"
      responses:
        200: # status code
          description: Transação.
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: number
                    example: 1
                  investment:
                    type: object
                    properties:
                      id:
                        type: number
                        example: 1
                      name:
                        type: string
                        example: "Ismael Alves"
                      createdAt:
                        type: string
                        example: "2021-03-31 22:34:36.476"
                      updatedAt:
                        type: string
                        example: "2021-03-31 22:34:36.476"
                  broker:
                    type: object
                    properties:
                      id:
                        type: number
                        example: 1
                      name:
                        type: string
                        example: "Ismael Alves"
                      createdAt:
                        type: string
                        example: "2021-03-31 22:34:36.476"
                      updatedAt:
                        type: string
                        example: "2021-03-31 22:34:36.476"
                  category:
                    type: object
                    properties:
                      id:
                        type: number
                        example: 1
                      name:
                        type: string
                        example: "Ismael Alves"
                      createdAt:
                        type: string
                        example: "2021-03-31 22:34:36.476"
                      updatedAt:
                        type: string
                        example: "2021-03-31 22:34:36.476"
                  type:
                    $ref: '#/components/schemas/TransactionTypeEnum'
                  negotiationDate:
                    type: string
                    example: "2022-01-15T18:33:31.550Z"
                  dueDate:
                    type: string
                    description: Campo passa ser obrigátorio se "type" for igual a "RENT"
                    example: "2022-01-15T18:33:31.550Z"
                  qnt:
                    type: number
                    example: 1
                  price:
                    type: number
                    description: "Formatação de valores Ex: R$ 10,00 === 1000"
                    example: 1000
                  total:
                    type: number
                    description: "Formatação de valores Ex: R$ 20,00 === 2000"
                    example: 2000
                  createdAt:
                    type: string
                    example: "2021-03-31 22:34:36.476"
                  updatedAt:
                    type: string
                    example: "2021-03-31 22:34:36.476"
        400: # status code
          $ref: "#/components/responses/badRequest"
        404: # status code
          $ref: "#/components/responses/notFound"
        500: # status code
          $ref: "#/components/responses/internal"
          
    put:
      tags:
        - Transaction
      summary: Atualiza uma Transação.
      parameters:
        - in: path
          required: true
          name: id
          description: ID da Transação
          schema:
            type: string
            example: "1"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/transaction"
      responses:
        200: # status code
          description: Retorna status.
          content:
            application/json:
              schema:
                type: string
                example: "Transação atualizada com sucesso!!!"
        400: # status code
          $ref: "#/components/responses/badRequest"
        404: # status code
          $ref: "#/components/responses/notFound"
        500: # status code
          $ref: "#/components/responses/internal"

    delete:
      tags:
        - Transaction
      summary: Deleta ua Transação.
      parameters:
        - in: path
          required: true
          name: id
          description: ID do Dividendo
          schema:
            type: string
            example: "1"
      responses:
        204: # status code
          description: Transação deletado com sucesso.
        400: # status code
          $ref: "#/components/responses/badRequest"
        404: # status code
          $ref: "#/components/responses/notFound"
        500: # status code
          $ref: "#/components/responses/internal"
          
  # Dividends
  /dividends:
    get:
      tags:
        - Dividends
      summary: Retorna a lista de dividendos.
      parameters:
        - in: query
          name: sortBy
          description: Atributo de ordenação
          schema:
            type: string
            example: "name"
        - in: query
          name: orderBy
          description: Tipo de ordenação (asc | desc)
          schema:
            type: string
            example: "asc"
        - in: query
          name: limit
          description: Limite de itens retornados
          schema:
            type: string
            example: "10"
        - in: query
          name: search
          description: Filtro de pesquisa
          schema:
            type: string
            example: {"name":"ismael"}
      responses:
        200: # status code
          $ref: "#/components/responses/dividends"

    post:
      tags:
        - Dividends
      summary: Criação de dividendos.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/dividends"
      responses:
        200: # status code
          description: Cadastro de dividendos.
          content:
            application/json:
              schema:
                type: string
                example: "Dividendo criado com sucesso!!!"
        400: # status code
          $ref: "#/components/responses/badRequest"
        500: # status code
          $ref: "#/components/responses/internal"

  /dividends/{id}:
    get:
      tags:
        - Dividends
      summary: Retorna um dividendo por ID.
      parameters:
        - in: path
          required: true
          name: id
          description: ID do dividendo
          schema:
            type: string
            example: "1"
      responses:
        200: # status code
          description: Dividendos.
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: number
                    example: 1
                  investment:
                    type: object
                    properties:
                      id:
                        type: number
                        example: 1
                      name:
                        type: string
                        example: "Ismael Alves"
                      createdAt:
                        type: string
                        example: "2021-03-31 22:34:36.476"
                      updatedAt:
                        type: string
                        example: "2021-03-31 22:34:36.476"
                  type:
                    $ref: '#/components/schemas/DividendsTypeEnum'
                  dueDate:
                    type: string
                    example: "2022-01-15T18:33:31.550Z"
                  qnt:
                    type: number
                    example: 1
                  price:
                    type: number
                    description: "Formatação de valores Ex: R$ 10,00 === 1000"
                    example: 1000
                  total:
                    type: number
                    description: "Formatação de valores Ex: R$ 20,00 === 2000"
                    example: 2000
                  createdAt:
                    type: string
                    example: "2021-03-31 22:34:36.476"
                  updatedAt:
                    type: string
                    example: "2021-03-31 22:34:36.476"
        400: # status code
          $ref: "#/components/responses/badRequest"
        404: # status code
          $ref: "#/components/responses/notFound"
        500: # status code
          $ref: "#/components/responses/internal"

    put:
      tags:
        - Dividends
      summary: Atualiza um Dividendo.
      parameters:
        - in: path
          required: true
          name: id
          description: ID do Dividendos
          schema:
            type: string
            example: "1"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/dividends"
      responses:
        200: # status code
          description: Retorna status.
          content:
            application/json:
              schema:
                type: string
                example: "Dividendo atualizado com sucesso!!!"
        400: # status code
          $ref: "#/components/responses/badRequest"
        404: # status code
          $ref: "#/components/responses/notFound"
        500: # status code
          $ref: "#/components/responses/internal"

    delete:
      tags:
        - Dividends
      summary: Deleta um Dividendo.
      parameters:
        - in: path
          required: true
          name: id
          description: ID do Dividendo
          schema:
            type: string
            example: "1"
      responses:
        204: # status code
          description: Dividendo deletado com sucesso.
        400: # status code
          $ref: "#/components/responses/badRequest"
        404: # status code
          $ref: "#/components/responses/notFound"
        500: # status code
          $ref: "#/components/responses/internal"

components:
  responses:
    badRequest:
      description: Falha na request.
      content:
        application/json:
          schema:
            type: array
            items:
              type: object
              required: 
                - message
              properties:
                message:
                  type: string

    notFound:
      description: valor não encontrado.
      content:
        application/json:
          schema:
            type: array
            items:
              type: object
              required: 
                - message
              properties:
                message:
                  type: string

    internal:
      description: erro interno.
      content:
        application/json:
          schema:
            type: array
            items:
              type: object
              required: 
                - message
              properties:
                message:
                  type: string

    category:
      description: lista de categorias.
      content:
        application/json:
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: number
                  example: 1
                name:
                  type: string
                  example: "Ismael Alves"
                createdAt:
                  type: string
                  example: "2021-03-31 22:34:36.476"
                updatedAt:
                  type: string
                  example: "2021-03-31 22:34:36.476"

    broker:
      description: lista de brokers.
      content:
        application/json:
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: number
                  example: 1
                name:
                  type: string
                  example: "Ismael Alves"
                createdAt:
                  type: string
                  example: "2021-03-31 22:34:36.476"
                updatedAt:
                  type: string
                  example: "2021-03-31 22:34:36.476"

    transaction:
      description: lista de transações.
      content:
        application/json:
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: number
                  example: 1
                investment:
                  type: object
                  properties:
                    id:
                      type: number
                      example: 1
                    name:
                      type: string
                      example: "Ismael Alves"
                    createdAt:
                      type: string
                      example: "2021-03-31 22:34:36.476"
                    updatedAt:
                      type: string
                      example: "2021-03-31 22:34:36.476"
                broker:
                  type: object
                  properties:
                    id:
                      type: number
                      example: 1
                    name:
                      type: string
                      example: "Ismael Alves"
                    createdAt:
                      type: string
                      example: "2021-03-31 22:34:36.476"
                    updatedAt:
                      type: string
                      example: "2021-03-31 22:34:36.476"
                category:
                  type: object
                  properties:
                    id:
                      type: number
                      example: 1
                    name:
                      type: string
                      example: "Ismael Alves"
                    createdAt:
                      type: string
                      example: "2021-03-31 22:34:36.476"
                    updatedAt:
                      type: string
                      example: "2021-03-31 22:34:36.476"
                type:
                  $ref: '#/components/schemas/TransactionTypeEnum'
                negotiationDate:
                  type: string
                  example: "2022-01-15T18:33:31.550Z"
                dueDate:
                  type: string
                  description: Campo passa ser obrigátorio se "type" for igual a "RENT"
                  example: "2022-01-15T18:33:31.550Z"
                qnt:
                  type: number
                  example: 1
                price:
                  type: number
                  description: "Formatação de valores Ex: R$ 10,00 === 1000"
                  example: 1000
                total:
                  type: number
                  description: "Formatação de valores Ex: R$ 20,00 === 2000"
                  example: 2000
                createdAt:
                  type: string
                  example: "2021-03-31 22:34:36.476"
                updatedAt:
                  type: string
                  example: "2021-03-31 22:34:36.476"
                  
    dividends:
      description: lista de dividendos.
      content:
        application/json:
          schema:
            type: array
            items:
              type: object
              properties:
                id:
                  type: number
                  example: 1
                investment:
                  type: object
                  properties:
                    id:
                      type: number
                      example: 1
                    name:
                      type: string
                      example: "Ismael Alves"
                    createdAt:
                      type: string
                      example: "2021-03-31 22:34:36.476"
                    updatedAt:
                      type: string
                      example: "2021-03-31 22:34:36.476"
                type:
                  $ref: '#/components/schemas/DividendsTypeEnum'
                dueDate:
                  type: string
                  example: "2022-01-15T18:33:31.550Z"
                qnt:
                  type: number
                  example: 1
                price:
                  type: number
                  description: "Formatação de valores Ex: R$ 10,00 === 1000"
                  example: 1000
                total:
                  type: number
                  description: "Formatação de valores Ex: R$ 20,00 === 2000"
                  example: 2000
                createdAt:
                  type: string
                  example: "2021-03-31 22:34:36.476"
                updatedAt:
                  type: string
                  example: "2021-03-31 22:34:36.476"

  schemas:
    category:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          example: "Ismael Alves"
          
    broker:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          example: "Ismael Alves"
    
    TransactionTypeEnum:
      type: string
      example: BUY
      enum:
        - BUY
        - SELL
        - RENT
    
    transaction:
      type: object
      required:
        - investment
        - broker
        - category
        - type
        - negotiationDate
        - qnt
        - price
      properties:
        investment:
          type: string
          example: "VISC11"
        broker:
          type: string
          example: "RICO INVESTIMENTOS"
        category:
          type: string
          example: "FIIS"
        type:
          $ref: '#/components/schemas/TransactionTypeEnum'
        negotiationDate:
          type: string
          example: "2022-01-15T18:33:31.550Z"
        dueDate:
          type: string
          description: Campo passa ser obrigátorio se "type" for igual a "RENT"
          example: "2022-01-15T18:33:31.550Z"
        qnt:
          type: number
          example: 1
        price:
          type: number
          description: "Formatação de valores Ex: R$ 10,00 === 1000"
          example: 1000
          
    DividendsTypeEnum:
      type: string
      example: BUY
      enum:
        - BUY
        - SELL
        - RENT
    
    dividends:
      type: object
      required:
        - investmentId
        - type
        - dueDate
        - qnt
        - price
      properties:
        investmentId:
          type: number
          example: 10
        type:
          $ref: '#/components/schemas/DividendsTypeEnum'
        dueDate:
          type: string
          example: "2022-01-15T18:33:31.550Z"
        qnt:
          type: number
          example: 1
        price:
          type: number
          description: "Formatação de valores Ex: R$ 10,00 === 1000"
          example: 1000
