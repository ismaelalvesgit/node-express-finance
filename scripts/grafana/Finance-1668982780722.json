{
  "__inputs": [
    {
      "name": "DS_MYSQL",
      "label": "MySQL",
      "description": "",
      "type": "datasource",
      "pluginId": "mysql",
      "pluginName": "MySQL"
    },
    {
      "name": "DS_JSON_API (CURRENCY)",
      "label": "JSON API (currency)",
      "description": "",
      "type": "datasource",
      "pluginId": "marcusolsson-json-datasource",
      "pluginName": "JSON API"
    }
  ],
  "__elements": [],
  "__requires": [
    {
      "type": "panel",
      "id": "barchart",
      "name": "Bar chart",
      "version": ""
    },
    {
      "type": "grafana",
      "id": "grafana",
      "name": "Grafana",
      "version": "8.4.3"
    },
    {
      "type": "panel",
      "id": "marcusolsson-calendar-panel",
      "name": "Calendar",
      "version": "0.7.1"
    },
    {
      "type": "datasource",
      "id": "marcusolsson-json-datasource",
      "name": "JSON API",
      "version": "1.3.2"
    },
    {
      "type": "datasource",
      "id": "mysql",
      "name": "MySQL",
      "version": "1.0.0"
    },
    {
      "type": "panel",
      "id": "piechart",
      "name": "Pie chart",
      "version": ""
    },
    {
      "type": "panel",
      "id": "stat",
      "name": "Stat",
      "version": ""
    },
    {
      "type": "panel",
      "id": "table",
      "name": "Table",
      "version": ""
    }
  ],
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": "-- Grafana --",
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "target": {
          "limit": 100,
          "matchAny": false,
          "tags": [],
          "type": "dashboard"
        },
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": null,
  "iteration": 1677186766984,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "blue",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 4,
        "x": 0,
        "y": 0
      },
      "id": 7,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT \n  sum(case\n    when inv.currency = \"USD\"\n      then total * $dolar\n    else total\n  end) as \"Total\" FROM finance.transaction tran\ninner join finance.investment inv on inv.id = tran.investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere YEAR(negotiationDate) = YEAR(CURRENT_DATE()) and cat.name in($category);",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "sum(balance)",
          "where": []
        }
      ],
      "title": "Movimentações do Ano",
      "type": "stat"
    },
    {
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "noValue": "R$ 0",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "blue",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 4,
        "x": 4,
        "y": 0
      },
      "id": 49,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT\n  sum(case\n    when inv.currency = \"USD\"\n      then(dy.total - dy.fees) * $dolar\n    else (dy.total - dy.fees)\n  end) as \"Total\" FROM finance.dividends dy\ninner join finance.investment inv on inv.id = dy.investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere YEAR(dueDate) = YEAR(CURRENT_DATE()) and dy.status = \"PAID\" and cat.name in($category);",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "sum(balance)",
          "where": []
        }
      ],
      "title": "Provendos do Ano",
      "type": "stat"
    },
    {
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "blue",
                "value": null
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 4,
        "x": 8,
        "y": 0
      },
      "id": 50,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "hide": false,
          "metricColumn": "none",
          "rawQuery": true,
          "rawSql": "SELECT\n  (sum(case\n    when inv.currency = \"USD\"\n      then dy.total * $dolar\n    else dy.total\n  end)/ (select sum(case\n    when currency = \"USD\"\n      then balance * $dolar\n    else balance\n  end) from finance.investment)) * 100 as \"Total\" FROM finance.dividends dy\ninner join finance.investment inv on inv.id = dy.investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere YEAR(dueDate) = YEAR(CURRENT_DATE()) and dy.status = \"PAID\" and cat.name in($category);",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "value"
                ],
                "type": "column"
              }
            ]
          ],
          "timeColumn": "time",
          "where": [
            {
              "name": "$__timeFilter",
              "params": [],
              "type": "macro"
            }
          ]
        }
      ],
      "title": "Retorno do Mês",
      "transformations": [],
      "type": "stat"
    },
    {
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 4,
        "x": 12,
        "y": 0
      },
      "id": 53,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT\n  sum(case\n    when inv.currency = \"USD\"\n      then balance * $dolar\n    else balance\n  end) as \"Total\"\nFROM finance.investment inv\ninner join finance.category cat on cat.id = inv.categoryId\nwhere cat.name in($category)",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "sum(balance)",
          "where": []
        }
      ],
      "title": "Patrimônio",
      "type": "stat"
    },
    {
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "noValue": "R$ 0",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 4,
        "x": 16,
        "y": 0
      },
      "id": 52,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT \n  sum(case\n    when inv.currency = \"USD\"\n      then total * $dolar\n    else total\n  end) as \"Total\" FROM finance.dividends dy\ninner join finance.investment inv on inv.id = dy.investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere cat.name in($category) and dy.status = \"PAID\";",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "sum(balance)",
          "where": []
        }
      ],
      "title": "Provendos",
      "type": "stat"
    },
    {
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 4,
        "x": 20,
        "y": 0
      },
      "id": 51,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "hide": false,
          "metricColumn": "none",
          "rawQuery": true,
          "rawSql": "SELECT (\n  (\n  \tselect sum(total)\n    end FROM finance.dividends dy\n  \tinner join finance.investment inv on inv.id = dy.investmentId\n  \tinner join finance.category cat on cat.id = inv.categoryId\n  \twhere cat.name in($category) and dy.status = \"PAID\" and cat.name != \"CRIPTOMOEDA\"\n  ) / sum(total)\n) * 100 as \"Percentual\" FROM finance.transaction tran\ninner join finance.investment inv on inv.id = tran.investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere cat.name in($category) and cat.name != \"CRIPTOMOEDA\"",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "value"
                ],
                "type": "column"
              }
            ]
          ],
          "timeColumn": "time",
          "where": [
            {
              "name": "$__timeFilter",
              "params": [],
              "type": "macro"
            }
          ]
        }
      ],
      "title": "Retorno",
      "transformations": [],
      "type": "stat"
    },
    {
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "green",
                "value": 1
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Percentual"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 4,
        "x": 0,
        "y": 5
      },
      "id": 38,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT \n(SUM(variationTotal) / SUM(balance)) * 100 as \"Percentual\"\nFROM finance.investment inv\ninner join finance.category cat on cat.id = inv.categoryId\nwhere cat.name in($category) and  inv.priceDay is not null",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "sum(balance)",
          "where": []
        }
      ],
      "title": "Valor Atual da carteira (%)",
      "type": "stat"
    },
    {
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "green",
                "value": 1
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Percentual"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 4,
        "x": 4,
        "y": 5
      },
      "id": 13,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT \n  sum(case\n    when inv.currency = \"USD\"\n      then variationTotal * $dolar\n    else variationTotal\n  end) as \"Total\"\nFROM finance.investment inv\ninner join finance.category cat on cat.id = inv.categoryId\nwhere cat.name in($category) and inv.priceDay is not null",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "sum(balance)",
          "where": []
        }
      ],
      "title": "Valor Atual da carteira (R$)",
      "type": "stat"
    },
    {
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "noValue": "R$ 0",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "green",
                "value": 1
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 8,
        "y": 5
      },
      "id": 14,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "hide": false,
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT (\n  (\n    select \n      sum(case\n        when inv.currency = \"USD\"\n          then total * $dolar\n        else total\n      end) from finance.dividends dy\n    inner join finance.investment inv on inv.id = dy.investmentId\n    inner join finance.category cat on cat.id = inv.categoryId\n    where dy.status = \"PAID\" and cat.name in($category)\n  ) + \n  sum(case\n    when inv.currency = \"USD\"\n      then variationTotal * $dolar\n    else variationTotal\n  end) + \n  (\n    select \n      sum(case\n        when inv.currency = \"USD\"\n          then tran.profit * $dolar\n        else tran.profit\n      end) from finance.transaction tran\n    inner join finance.investment inv on inv.id = tran.investmentId\n    inner join finance.category cat on cat.id = inv.categoryId\n    where cat.name in($category)\n  )\n)\nAS \"Total\"\nFROM finance.investment inv\ninner join finance.category cat on cat.id = inv.categoryId\nwhere inv.priceDay is not null and inv.balance > 0 and cat.name in($category)",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "sum(balance)",
          "where": []
        }
      ],
      "title": "Cotação + Dividendos + Lucros/Prejuizo",
      "transformations": [],
      "type": "stat"
    },
    {
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "green",
                "value": 1
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 4,
        "x": 16,
        "y": 5
      },
      "id": 20,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "hide": false,
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT \n  case\n    when currency = \"USD\"\n      then sum(variationDayTotal) * $dolar\n    else sum(variationDayTotal)\n  end  AS \"Total\"\nFROM finance.view_investment\nwhere category ->> \"$.name\" in($category)",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "sum(balance)",
          "where": []
        }
      ],
      "title": "Variação Total",
      "transformations": [],
      "type": "stat"
    },
    {
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "green",
                "value": 1
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 4,
        "x": 20,
        "y": 5
      },
      "id": 39,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "hide": false,
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT \ncase\n  when currency = \"USD\"\n    then sum((priceDay - previousClosePrice) * qnt) * $dolar\n  else sum((priceDay - previousClosePrice) * qnt)\nend AS \"Total\" from finance.view_investment\nwhere priceDay is not null and previousClosePrice is not null and balance > 0 and category ->> \"$.name\" in($category)",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "sum(balance)",
          "where": []
        }
      ],
      "title": "Lucro / Prejuizo do dia",
      "transformations": [],
      "type": "stat"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "#15d17e",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 0,
        "y": 13
      },
      "id": 12,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "time_series",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT\n  inv.updatedAt AS \"time\",\n  case\n    when inv.currency = \"USD\"\n      then inv.priceDay * $dolar\n    else inv.priceDay\n  end AS \"Preço\",\n  inv.name\nFROM finance.investment inv\ninner join finance.category cat on cat.id = inv.categoryId\nwhere cat.name in($category) and inv.balance > 0\nORDER BY inv.updatedAt ",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "updatedAt",
          "where": []
        }
      ],
      "title": "Cotação do dia",
      "type": "stat"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 4,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "green",
                "value": ""
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Preço REET"
            },
            "properties": [
              {
                "id": "unit",
                "value": "currencyUSD"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Preço SRET"
            },
            "properties": [
              {
                "id": "unit",
                "value": "currencyUSD"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 12,
        "y": 13
      },
      "id": 8,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "time_series",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT\n  inv.updatedAt AS \"time\",\n  case\n    when inv.currency = \"USD\"\n      then inv.variationDay * $dolar\n    else inv.variationDay\n  end AS \"Preço\",\n  inv.name\nFROM finance.investment inv\ninner join finance.category cat on cat.id = inv.categoryId\nwhere cat.name in($category) and inv.balance > 0\nORDER BY inv.updatedAt",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "updatedAt",
          "where": []
        }
      ],
      "title": "Variação do dia",
      "type": "stat"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "fixed"
          },
          "custom": {
            "align": "center",
            "displayMode": "color-text",
            "filterable": true
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Total de Aportes"
            },
            "properties": [
              {
                "id": "unit",
                "value": "currencyBRL"
              },
              {
                "id": "decimals",
                "value": 2
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Preço Médio"
            },
            "properties": [
              {
                "id": "unit",
                "value": "currencyBRL"
              },
              {
                "id": "decimals",
                "value": 2
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Cotação Hoje"
            },
            "properties": [
              {
                "id": "unit",
                "value": "currencyBRL"
              },
              {
                "id": "decimals",
                "value": 2
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Saldo Atual"
            },
            "properties": [
              {
                "id": "unit",
                "value": "currencyBRL"
              },
              {
                "id": "decimals",
                "value": 2
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Lucro/Prejuízo"
            },
            "properties": [
              {
                "id": "unit",
                "value": "currencyBRL"
              },
              {
                "id": "decimals",
                "value": 2
              },
              {
                "id": "color",
                "value": {
                  "mode": "thresholds"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "red",
                      "value": null
                    },
                    {
                      "color": "green",
                      "value": 0
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Saldo (%)"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "decimals",
                "value": 2
              },
              {
                "id": "color",
                "value": {
                  "mode": "thresholds"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "red",
                      "value": null
                    },
                    {
                      "color": "green",
                      "value": 0
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "(%) Da Carteira"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "decimals",
                "value": 2
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Logo"
            },
            "properties": [
              {
                "id": "custom.displayMode",
                "value": "image"
              },
              {
                "id": "custom.align",
                "value": "center"
              },
              {
                "id": "custom.width",
                "value": 80
              },
              {
                "id": "custom.filterable",
                "value": false
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Dividendos"
            },
            "properties": [
              {
                "id": "unit",
                "value": "currencyBRL"
              },
              {
                "id": "noValue",
                "value": "R$ 0"
              },
              {
                "id": "decimals",
                "value": 2
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 10,
        "w": 18,
        "x": 0,
        "y": 22
      },
      "id": 25,
      "options": {
        "footer": {
          "fields": [
            "Total de Cotas",
            "Total de Aportes",
            "Preço Médio",
            "Cotação Hoje",
            "Saldo Atual",
            "Lucro/Prejuízo"
          ],
          "reducer": [
            "sum"
          ],
          "show": true
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": false,
            "displayName": "Lucro/Prejuízo"
          }
        ]
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "none",
          "rawQuery": true,
          "rawSql": "select\ninv.logoUrl as \"Logo\",\ninv.name as \"Código\",\ninv.qnt as \"Total de Cotas\",\ninv.balance as \"Total de Aportes\",\n(\n  select sum(dy.total - dy.fees) from finance.dividends dy where dy.investmentId = inv.id and dy.status = \"PAID\"\n) as \"Dividendos\",\ninv.priceAverage as \"Preço Médio\",\ninv.priceDay as \"Cotação Hoje\",\nsum(inv.balance + inv.variationTotal) as \"Saldo Atual\",\ninv.variationTotal as \"Lucro/Prejuízo\",\ninv.changePercentTotal as \"Saldo (%)\",\ninv.percent as \"(%) Da Carteira\",\nreplace(inv.category -> \"$.name\", '\"', '') as \"Categoria\",\ninv.sector as \"Seguemento\"\nfrom finance.view_investment inv\nwhere balance > 0 and category ->> \"$.name\" in($category)\ngroup by inv.id\norder by inv.balance desc",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "value"
                ],
                "type": "column"
              }
            ]
          ],
          "timeColumn": "time",
          "where": [
            {
              "name": "$__timeFilter",
              "params": [],
              "type": "macro"
            }
          ]
        }
      ],
      "title": "Carteira",
      "type": "table"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "center",
            "displayMode": "auto",
            "filterable": true
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Qnt"
            },
            "properties": [
              {
                "id": "unit",
                "value": "string"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 10,
        "w": 6,
        "x": 18,
        "y": 22
      },
      "id": 27,
      "options": {
        "footer": {
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": true
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": false,
            "displayName": "Data"
          }
        ]
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "none",
          "rawQuery": true,
          "rawSql": "SELECT\ninv.name as \"Código\",\ntran.price as \"Preço\",\nsum(tran.qnt) as \"Qnt\",\ncase\n\twhen tran.type = \"SELL\" THEN tran.total - ABS(tran.profit)\n  else tran.total\nend as \"Total\",\nDATE_FORMAT(tran.negotiationDate, \"%d/%m/%y\") as \"Data\"\nFROM finance.transaction tran\ninner join finance.investment inv on inv.id = tran.investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere negotiationDate > last_day(now() - INTERVAL 1 MONTH) AND cat.name in($category)\ngroup by inv.id, tran.negotiationDate, tran.createdAt\norder by tran.negotiationDate, tran.createdAt\n",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "value"
                ],
                "type": "column"
              }
            ]
          ],
          "timeColumn": "time",
          "where": [
            {
              "name": "$__timeFilter",
              "params": [],
              "type": "macro"
            }
          ]
        }
      ],
      "title": "Últimas compras (1M)",
      "type": "table"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": [],
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 7,
        "x": 0,
        "y": 32
      },
      "id": 23,
      "options": {
        "displayLabels": [
          "percent"
        ],
        "legend": {
          "displayMode": "table",
          "placement": "right"
        },
        "pieType": "pie",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "tooltip": {
          "mode": "multi",
          "sort": "asc"
        }
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "time_series",
          "group": [],
          "hide": false,
          "metricColumn": "balance",
          "rawQuery": true,
          "rawSql": "SELECT\n  dy.updatedAt AS \"time\",\n  case\n    when inv.currency = \"USD\"\n      then sum(dy.total - dy.fees) * $dolar\n    else sum(dy.total - dy.fees)\n  end as \"Dividendo\",\n  inv.name as Nome,\n  case\n    when inv.currency = \"USD\"\n      then CONCAT('R$ ', FORMAT(sum(dy.total - dy.fees) * $dolar, 2))\n    else CONCAT('R$ ', FORMAT(sum(dy.total - dy.fees), 2))\n  end  as \"Valor\",\n  DATE_FORMAT(dy.dueDate, '%d-%b') as 'Dt Pag'\nFROM finance.dividends dy\ninner join finance.investment inv on inv.id = dy.investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere dy.status = \"PROVISIONED\" and inv.balance > 0 and cat.name in($category)\ngroup by inv.id, dy.dueDate\nORDER BY dy.updatedAt",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "balance"
                ],
                "type": "column"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "updatedAt",
          "where": []
        }
      ],
      "title": "Dividendo Provisionado",
      "type": "piechart"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": []
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 7,
        "y": 32
      },
      "id": 41,
      "options": {
        "displayLabels": [
          "percent"
        ],
        "legend": {
          "displayMode": "table",
          "placement": "right"
        },
        "pieType": "pie",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "tooltip": {
          "mode": "multi",
          "sort": "asc"
        }
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "time_series",
          "group": [],
          "hide": false,
          "metricColumn": "balance",
          "rawQuery": true,
          "rawSql": "SELECT\n  dy.updatedAt AS \"time\",\n  sum(case\n    when inv.currency = \"USD\"\n      then (dy.total - dy.fees) * $dolar\n    else (dy.total - dy.fees)\n  end) as \"Dividendo\",\n  cat.name as Nome,\n  case\n    when inv.currency = \"USD\"\n      then CONCAT('R$ ', FORMAT(sum(dy.total - dy.fees) * $dolar, 2)) \n    else CONCAT('R$ ', FORMAT(sum(dy.total - dy.fees), 2))\n  end as \"Valor\"\nFROM finance.dividends dy\ninner join finance.investment inv on inv.id = dy.investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere dy.status = \"PAID\"\ngroup by inv.categoryId\nORDER BY dy.updatedAt",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "balance"
                ],
                "type": "column"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "updatedAt",
          "where": []
        }
      ],
      "title": "Dividendo Pago",
      "transformations": [],
      "type": "piechart"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "semi-dark-green",
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "decimals": 2,
          "mappings": [],
          "unit": "currencyBRL"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Mês Anterior"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 13,
        "y": 32
      },
      "id": 16,
      "options": {
        "displayLabels": [
          "name",
          "value"
        ],
        "legend": {
          "displayMode": "hidden",
          "placement": "bottom"
        },
        "pieType": "donut",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "hide": false,
          "metricColumn": "balance",
          "rawQuery": true,
          "rawSql": "SELECT\n  sum(case\n    when inv.currency = \"USD\"\n      then (dy.total - dy.fees) * $dolar\n    else dy.total - dy.fees\n  end) as \"Mês Atual\"\nFROM finance.dividends dy\ninner join finance.investment inv on inv.id = dy.investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere inv.balance > 0 and dy.dueDate > last_day(now() - INTERVAL 1 MONTH) and dy.dueDate <= last_day(now()) and cat.name in($category)",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "balance"
                ],
                "type": "column"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "updatedAt",
          "where": []
        },
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "hide": false,
          "metricColumn": "none",
          "rawQuery": true,
          "rawSql": "SELECT \n  sum(case\n    when inv.currency = \"USD\"\n      then (dy.total - dy.fees) * $dolar\n    else dy.total - dy.fees\n  end) as \"Mês Anterior\"\nFROM finance.dividends dy\ninner join finance.investment inv on inv.id = dy.investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere dy.status = \"PAID\" and dy.dueDate > last_day(now() - INTERVAL 2 MONTH) and dy.dueDate <= last_day(now() - INTERVAL 1 MONTH) and cat.name in($category)",
          "refId": "B",
          "select": [
            [
              {
                "params": [
                  "value"
                ],
                "type": "column"
              }
            ]
          ],
          "timeColumn": "time",
          "where": [
            {
              "name": "$__timeFilter",
              "params": [],
              "type": "macro"
            }
          ]
        }
      ],
      "title": "(Dividendos)  Mês Atual x Mês Anterior",
      "transformations": [],
      "type": "piechart"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 5,
        "x": 19,
        "y": 32
      },
      "id": 37,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "none",
          "rawQuery": true,
          "rawSql": "select\n  sum(case\n    when inv.currency = \"USD\"\n      then (inv.qnt * dy.price) * $dolar\n    else inv.qnt * dy.price\n  end) from finance.dividends dy\ninner join finance.view_investment inv on inv.id = dy.investmentId\nwhere dy.id in (select max(tmp.id) from finance.dividends tmp where tmp.dueDate < last_day(now() - INTERVAL 1 MONTH) group by tmp.investmentId) and \ninv.category ->> \"$.name\" in($category);",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "value"
                ],
                "type": "column"
              }
            ]
          ],
          "timeColumn": "time",
          "where": [
            {
              "name": "$__timeFilter",
              "params": [],
              "type": "macro"
            }
          ]
        }
      ],
      "title": "Renda Média Estimada (1M)",
      "type": "stat"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Veja",
              "url": "${__data.fields.link}"
            }
          ],
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 40
      },
      "id": 22,
      "options": {
        "autoScroll": true,
        "descriptionField": "metric",
        "labelFields": [
          "name"
        ],
        "quickLinks": false,
        "textField": "metric"
      },
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "time_series",
          "group": [],
          "metricColumn": "description",
          "rawQuery": true,
          "rawSql": "SELECT\n  DATE_ADD(even.dateReference, INTERVAL 1 DAY) AS \"time\",\n  even.description AS metric,\n  even.link,\n  inv.name\nFROM finance.events even\ninner join finance.investment inv on inv.id = even.investmentId\nORDER BY even.dateReference",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "value"
                ],
                "type": "column"
              }
            ]
          ],
          "table": "finance.events",
          "timeColumn": "dateDelivery",
          "where": []
        }
      ],
      "title": "Eventos Coorporativos",
      "type": "marcusolsson-calendar-panel"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "center",
            "displayMode": "lcd-gauge",
            "filterable": false
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Ùltimo dividendo"
            },
            "properties": [
              {
                "id": "decimals",
                "value": 2
              },
              {
                "id": "unit",
                "value": "currencyBRL"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Nome"
            },
            "properties": [
              {
                "id": "custom.displayMode",
                "value": "color-text"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Categoria"
            },
            "properties": [
              {
                "id": "custom.displayMode",
                "value": "color-text"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 40
      },
      "id": 40,
      "options": {
        "footer": {
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Rendimento (%PM) 12M"
          }
        ]
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "none",
          "rawQuery": true,
          "rawSql": "select \ninv.name as \"Nome\",\nreplace(inv.category -> \"$.name\", '\"', '') as \"Categoria\",\ndy.price as \"Ùltimo dividendo\", \n((dy.price / inv.priceAverage) * 100) as \"Rendimento (%PM)\", \n((dy.price / inv.priceAverage) * 100) * 12 as \"Rendimento (%PM) 12M\"\nfrom finance.dividends dy\ninner join finance.view_investment inv on inv.id = dy.investmentId\nwhere dy.id in (select max(tmp.id) from finance.dividends tmp group by tmp.investmentId) and inv.balance > 0 and category ->>\"$.name\" in($category)\ngroup by dy.investmentId;",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "value"
                ],
                "type": "column"
              }
            ]
          ],
          "timeColumn": "time",
          "where": [
            {
              "name": "$__timeFilter",
              "params": [],
              "type": "macro"
            }
          ]
        }
      ],
      "title": "Renda Média Estimada",
      "type": "table"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": [],
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 48
      },
      "id": 2,
      "options": {
        "displayLabels": [
          "percent"
        ],
        "legend": {
          "displayMode": "table",
          "placement": "right"
        },
        "pieType": "pie",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "tooltip": {
          "mode": "single",
          "sort": "asc"
        }
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "time_series",
          "group": [],
          "hide": false,
          "metricColumn": "balance",
          "rawQuery": true,
          "rawSql": "SELECT\n  inv.updatedAt AS \"time\",\n  case\n    when inv.currency = \"USD\"\n      then inv.balance * $dolar\n    else inv.balance\n  end as \"Balanço\",\n  inv.name as Nome,\n  case\n    when inv.currency = \"USD\"\n      then CONCAT('R$ ', FORMAT(inv.balance * $dolar, 2)) \n    else CONCAT('R$ ', FORMAT(inv.balance, 2))\n  end as \"Valor\"\nFROM finance.investment inv\ninner join finance.category cat on cat.id = inv.categoryId\nwhere cat.name in($category) and inv.balance > 0\nORDER BY inv.updatedAt",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "balance"
                ],
                "type": "column"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "updatedAt",
          "where": []
        }
      ],
      "title": "Patrimônio por ativo",
      "type": "piechart"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": [],
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 48
      },
      "id": 5,
      "options": {
        "displayLabels": [
          "percent"
        ],
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "values": [
            "value",
            "percent"
          ]
        },
        "pieType": "pie",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "tooltip": {
          "mode": "multi",
          "sort": "asc"
        }
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "time_series",
          "group": [],
          "hide": false,
          "metricColumn": "balance",
          "rawQuery": true,
          "rawSql": "SELECT\n  inv.updatedAt as time_sec,\n  case\n    when inv.currency = \"USD\"\n      then sum(inv.balance) * $dolar\n    else sum(inv.balance)\n  end as \"Balanço\",\n  inv.sector as Nome\nFROM finance.investment inv\ninner join finance.category cat on cat.id = inv.categoryId\nwhere cat.name in($category) and inv.balance > 0\ngroup by inv.sector\nORDER BY 1",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "balance"
                ],
                "type": "column"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "updatedAt",
          "where": []
        }
      ],
      "title": "Patrimônio por categoria",
      "type": "piechart"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "axisSoftMax": 1,
            "axisSoftMin": 0,
            "fillOpacity": 80,
            "gradientMode": "hue",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "log": 2,
              "type": "log"
            }
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "purple",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Rendimento (%PM)"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Rendimento (%PM) 12M"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 0,
        "y": 56
      },
      "id": 9,
      "options": {
        "barRadius": 0,
        "barWidth": 1,
        "colorByField": "Dividendo",
        "groupWidth": 0.7,
        "legend": {
          "calcs": [],
          "displayMode": "hidden",
          "placement": "bottom"
        },
        "orientation": "auto",
        "showValue": "auto",
        "stacking": "none",
        "text": {},
        "tooltip": {
          "mode": "single",
          "sort": "desc"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT\n  sum(dy.total - dy.fees) AS \"Dividendo\",\n  (((select d.price from finance.dividends d where d.investmentId = dy.investmentId order by d.dueDate desc limit 1) / inv.priceAverage) * 100) as \"Rendimento (%PM)\", \n  (((select d.price from finance.dividends d where d.investmentId = dy.investmentId order by d.dueDate desc limit 1)/ inv.priceAverage) * 100) * 12 as \"Rendimento (%PM) 12M\",\n  inv.name as \"Nome\"\nFROM finance.dividends dy\ninner join finance.view_investment inv on inv.id = dy.investmentId\nwhere dy.status = \"PAID\" AND dy.total > 0 AND inv.category -> \"$.id\" = 1\ngroup by inv.id\nORDER BY sum(dy.total - dy.fees) asc",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "updatedAt",
          "where": []
        }
      ],
      "title": "Total de Dividendos pagos por ATIVO (FIIS)",
      "type": "barchart"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "axisSoftMax": 1,
            "axisSoftMin": 0,
            "fillOpacity": 80,
            "gradientMode": "hue",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "log": 2,
              "type": "log"
            }
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "orange",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Rendimento (%PM)"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Rendimento (%PM) 12M"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 12,
        "y": 56
      },
      "id": 45,
      "options": {
        "barRadius": 0,
        "barWidth": 1,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "orientation": "auto",
        "showValue": "auto",
        "stacking": "none",
        "text": {},
        "tooltip": {
          "mode": "single",
          "sort": "desc"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT\n  sum(dy.total - dy.fees) AS \"Dividendo\",\n  (((select d.price from finance.dividends d where d.investmentId = dy.investmentId order by d.dueDate desc limit 1) / inv.priceAverage) * 100) as \"Rendimento (%PM)\", \n  (((select d.price from finance.dividends d where d.investmentId = dy.investmentId order by d.dueDate desc limit 1)/ inv.priceAverage) * 100) * 12 as \"Rendimento (%PM) 12M\",\n  inv.name as \"Nome\"\nFROM finance.dividends dy\ninner join finance.view_investment inv on inv.id = dy.investmentId\nwhere dy.status = \"PAID\" AND dy.total > 0 AND inv.category -> \"$.id\" = 2\ngroup by inv.id\nORDER BY sum(dy.total - dy.fees) asc",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "updatedAt",
          "where": []
        }
      ],
      "title": "Total de Dividendos pagos por ATIVO (AÇÃO)",
      "type": "barchart"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "axisSoftMax": 1,
            "axisSoftMin": 0,
            "fillOpacity": 80,
            "gradientMode": "hue",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "log": 2,
              "type": "log"
            }
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Rendimento (%PM)"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Rendimento (%PM) 12M"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 0,
        "y": 65
      },
      "id": 46,
      "options": {
        "barRadius": 0,
        "barWidth": 1,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "orientation": "auto",
        "showValue": "auto",
        "stacking": "none",
        "text": {},
        "tooltip": {
          "mode": "single",
          "sort": "desc"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT\n  sum(case\n    when inv.currency = \"USD\"\n      then (dy.total - dy.fees) * $dolar\n    else dy.total - dy.fees \n  end) AS \"Dividendo\",\n  (((select d.price from finance.dividends d where d.investmentId = dy.investmentId order by d.dueDate desc limit 1) / inv.priceAverage) * 100) as \"Rendimento (%PM)\", \n  (((select d.price from finance.dividends d where d.investmentId = dy.investmentId order by d.dueDate desc limit 1)/ inv.priceAverage) * 100) * 12 as \"Rendimento (%PM) 12M\",\n  inv.name as \"Nome\"\nFROM finance.dividends dy\ninner join finance.view_investment inv on inv.id = dy.investmentId\nwhere dy.status = \"PAID\" AND dy.total > 0 AND inv.category -> \"$.id\" = 6\ngroup by inv.id\nORDER BY sum(dy.total - dy.fees) asc",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "updatedAt",
          "where": []
        }
      ],
      "title": "Total de Dividendos pagos por ATIVO (ETF EX)",
      "type": "barchart"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "axisSoftMax": 1,
            "axisSoftMin": 0,
            "fillOpacity": 80,
            "gradientMode": "hue",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "log": 2,
              "type": "log"
            }
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Rendimento (%PM)"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Rendimento (%PM) 12M"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 12,
        "y": 65
      },
      "id": 47,
      "options": {
        "barRadius": 0,
        "barWidth": 1,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "orientation": "auto",
        "showValue": "auto",
        "stacking": "none",
        "text": {},
        "tooltip": {
          "mode": "single",
          "sort": "desc"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT\n  sum(case\n    when inv.currency = \"USD\"\n      then (dy.total - dy.fees) * $dolar\n    else dy.total - dy.fees\n  end) AS \"Dividendo\",\n  (((select d.price from finance.dividends d where d.investmentId = dy.investmentId order by d.dueDate desc limit 1) / inv.priceAverage) * 100) as \"Rendimento (%PM)\", \n  (((select d.price from finance.dividends d where d.investmentId = dy.investmentId order by d.dueDate desc limit 1) / inv.priceAverage) * 100) * 12 as \"Rendimento (%PM) 12M\",\n  inv.name as \"Nome\"\nFROM finance.dividends dy\ninner join finance.view_investment inv on inv.id = dy.investmentId\nwhere dy.status = \"PAID\" AND dy.total > 0 AND inv.category -> \"$.id\" = 5\ngroup by inv.id\nORDER BY sum(dy.total - dy.fees) asc",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "updatedAt",
          "where": []
        }
      ],
      "title": "Total de Dividendos pagos por ATIVO (EQUITY)",
      "type": "barchart"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "log": 2,
              "type": "log"
            }
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "yellow",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 0,
        "y": 74
      },
      "id": 11,
      "options": {
        "barRadius": 0,
        "barWidth": 0.97,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "orientation": "auto",
        "showValue": "auto",
        "stacking": "none",
        "tooltip": {
          "mode": "single",
          "sort": "none"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT\n  sum(\n     case \n      when inv.currency = \"USD\"\n        then (dy.total - dy.fees) * $dolar\n      else dy.total - dy.fees\n     end\n ) AS \"Dividendo\",\n DATE_FORMAT(dy.dueDate, \"%m/%y\") as \"Date\"\nFROM finance.dividends dy\ninner join finance.investment inv on inv.id = dy.investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere dy.status = \"PAID\" AND dy.dueDate >= last_day(now() - INTERVAL 1 YEAR) and cat.name in($category)\nGROUP BY DATE_FORMAT(dy.dueDate, \"%m/%y\")\norder by dy.dueDate asc",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "updatedAt",
          "where": []
        }
      ],
      "title": "Total de Dividendos pagos por MÊS",
      "type": "barchart"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "log": 2,
              "type": "log"
            }
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "blue",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 12,
        "y": 74
      },
      "id": 10,
      "options": {
        "barRadius": 0,
        "barWidth": 0.97,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "orientation": "auto",
        "showValue": "auto",
        "stacking": "none",
        "tooltip": {
          "mode": "single",
          "sort": "none"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "metricColumn": "priceDay",
          "rawQuery": true,
          "rawSql": "SELECT\n  sum(\n    case\n      when inv.currency = \"USD\"\n        then (dy.total - dy.fees) * $dolar\n      else dy.total - dy.fees\n    end\n  ) AS \"Dividendo\",\n  \"Total de dividendos recebidos\"\nFROM finance.dividends dy\ninner join finance.investment inv on inv.id = dy.investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere dy.status = \"PAID\" and cat.name in($category)\nORDER BY dy.createdAt",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "priceDay"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ],
            [
              {
                "params": [
                  "name"
                ],
                "type": "column"
              },
              {
                "params": [
                  "avg"
                ],
                "type": "aggregate"
              },
              {
                "params": [
                  "priceDay"
                ],
                "type": "alias"
              }
            ]
          ],
          "table": "finance.investment",
          "timeColumn": "updatedAt",
          "where": []
        }
      ],
      "title": "Total de Dividendos pagos",
      "type": "barchart"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "green",
            "mode": "fixed"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "log": 2,
              "type": "log"
            }
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "yellow",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 9,
        "w": 24,
        "x": 0,
        "y": 83
      },
      "id": 19,
      "options": {
        "barRadius": 0,
        "barWidth": 0.97,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "orientation": "auto",
        "showValue": "auto",
        "stacking": "none",
        "tooltip": {
          "mode": "single",
          "sort": "none"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "hide": false,
          "metricColumn": "total",
          "rawQuery": true,
          "rawSql": "SELECT\n  DATE_FORMAT(t.negotiationDate, \"%m/%y\") as \"Date\",\n  (\n    select \n      sum(case\n        when inv.currency = \"USD\"\n          then t2.total * $dolar\n        else t2.total\n      end)\n    from finance.transaction t2 \n    inner join finance.investment inv on inv.id = t2.investmentId\n    inner join finance.category cat on cat.id = inv.categoryId\n    where t2.negotiationDate <= LAST_DAY(t.negotiationDate) and cat.name in($category)\n  ) as \"Total Compra\"\nfrom finance.transaction t\ninner join finance.investment inv on inv.id = t.investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere t.negotiationDate >= last_day(now() - INTERVAL 1 YEAR) and cat.name in($category)\ngroup by DATE_FORMAT(negotiationDate, \"%m/%y\")\norder by t.negotiationDate asc;",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "total"
                ],
                "type": "column"
              }
            ]
          ],
          "table": "finance.transaction",
          "timeColumn": "negotiationDate",
          "where": []
        }
      ],
      "title": "Patrimônio (Evolução)",
      "transformations": [
        {
          "id": "merge",
          "options": {}
        }
      ],
      "type": "barchart"
    },
    {
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "blue",
            "mode": "fixed"
          },
          "custom": {
            "axisLabel": "",
            "axisPlacement": "auto",
            "axisSoftMin": 0,
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineWidth": 1,
            "scaleDistribution": {
              "log": 2,
              "type": "log"
            }
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "blue",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Total Venda"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 6,
        "w": 24,
        "x": 0,
        "y": 92
      },
      "id": 18,
      "options": {
        "barRadius": 0,
        "barWidth": 0.97,
        "groupWidth": 0.7,
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom"
        },
        "orientation": "auto",
        "showValue": "auto",
        "stacking": "none",
        "tooltip": {
          "mode": "single",
          "sort": "none"
        },
        "xTickLabelRotation": 0,
        "xTickLabelSpacing": 0
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "hide": false,
          "metricColumn": "total",
          "rawQuery": true,
          "rawSql": "SELECT\n   DATE_FORMAT(negotiationDate, \"%m/%y\") as \"Date\",\n   sum(case\n    when inv.currency = \"USD\"\n      then total * $dolar\n    else total\n   end) AS \"Total Compra\"\nFROM finance.transaction\ninner join finance.investment inv on inv.id = investmentId  \ninner join finance.category cat on cat.id = inv.categoryId\nwhere `type` = \"BUY\" AND negotiationDate >= last_day(now() - INTERVAL 1 YEAR) and cat.name in($category)\nGROUP BY  DATE_FORMAT(negotiationDate, \"%m/%y\")\norder by negotiationDate asc",
          "refId": "A",
          "select": [
            [
              {
                "params": [
                  "total"
                ],
                "type": "column"
              }
            ]
          ],
          "table": "finance.transaction",
          "timeColumn": "negotiationDate",
          "where": []
        },
        {
          "datasource": {
            "type": "mysql",
            "uid": "${DS_MYSQL}"
          },
          "format": "table",
          "group": [],
          "hide": false,
          "metricColumn": "total",
          "rawQuery": true,
          "rawSql": "SELECT\n  DATE_FORMAT(negotiationDate, \"%m/%y\") as \"Date\",\n  sum(case\n    when inv.currency = \"USD\"\n      then ABS(qnt) * price * $dolar\n    else ABS(qnt) * price\n  end) AS \"Total Venda\"\nFROM finance.transaction\ninner join finance.investment inv on inv.id = investmentId\ninner join finance.category cat on cat.id = inv.categoryId\nwhere `type` = \"SELL\" AND negotiationDate >= last_day(now() - INTERVAL 1 YEAR) and cat.name in($category)\nGROUP BY DATE_FORMAT(negotiationDate, \"%m/%y\")\norder by negotiationDate asc",
          "refId": "B",
          "select": [
            [
              {
                "params": [
                  "total"
                ],
                "type": "column"
              }
            ]
          ],
          "table": "finance.transaction",
          "timeColumn": "negotiationDate",
          "where": []
        }
      ],
      "title": "Movimentações",
      "transformations": [
        {
          "id": "merge",
          "options": {}
        }
      ],
      "type": "barchart"
    },
    {
      "datasource": {
        "type": "marcusolsson-json-datasource",
        "uid": "${DS_JSON_API (CURRENCY)}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 5
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 3,
        "x": 0,
        "y": 98
      },
      "id": 29,
      "interval": "30s",
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "sum"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "cacheDurationSeconds": 300,
          "datasource": {
            "type": "marcusolsson-json-datasource",
            "uid": "${DS_JSON_API (CURRENCY)}"
          },
          "fields": [
            {
              "jsonPath": "$.USDBRL.bid",
              "type": "number"
            }
          ],
          "method": "GET",
          "queryParams": "",
          "refId": "A",
          "urlPath": "/last/USD-BRL"
        }
      ],
      "title": "Dólar Americano (compra)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "marcusolsson-json-datasource",
        "uid": "${DS_JSON_API (CURRENCY)}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 5
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 3,
        "x": 3,
        "y": 98
      },
      "id": 30,
      "interval": "30s",
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "sum"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "cacheDurationSeconds": 300,
          "datasource": {
            "type": "marcusolsson-json-datasource",
            "uid": "${DS_JSON_API (CURRENCY)}"
          },
          "fields": [
            {
              "jsonPath": "$.EURBRL.bid",
              "type": "number"
            }
          ],
          "method": "GET",
          "queryParams": "",
          "refId": "A",
          "urlPath": "/last/EUR-BRL"
        }
      ],
      "title": "Euro (compra)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "marcusolsson-json-datasource",
        "uid": "${DS_JSON_API (CURRENCY)}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "blue",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 3,
        "x": 6,
        "y": 98
      },
      "id": 34,
      "interval": "30s",
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "sum"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "cacheDurationSeconds": 300,
          "datasource": {
            "type": "marcusolsson-json-datasource",
            "uid": "${DS_JSON_API (CURRENCY)}"
          },
          "fields": [
            {
              "jsonPath": "$.CHFBRL.bid",
              "type": "number"
            }
          ],
          "method": "GET",
          "queryParams": "",
          "refId": "A",
          "urlPath": "/last/CHF-BRL"
        }
      ],
      "title": "Franco Suíço (compra)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "marcusolsson-json-datasource",
        "uid": "${DS_JSON_API (CURRENCY)}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "purple",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 3,
        "x": 9,
        "y": 98
      },
      "id": 36,
      "interval": "30s",
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "sum"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "cacheDurationSeconds": 300,
          "datasource": {
            "type": "marcusolsson-json-datasource",
            "uid": "${DS_JSON_API (CURRENCY)}"
          },
          "fields": [
            {
              "jsonPath": "$.CADBRL.bid",
              "type": "number"
            }
          ],
          "method": "GET",
          "queryParams": "",
          "refId": "A",
          "urlPath": "/last/CAD-BRL"
        }
      ],
      "title": "Dólar Canadense (compra)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "marcusolsson-json-datasource",
        "uid": "${DS_JSON_API (CURRENCY)}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 3,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 3,
        "x": 12,
        "y": 98
      },
      "id": 32,
      "interval": "30s",
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "sum"
          ],
          "fields": "/^bid$/",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "cacheDurationSeconds": 300,
          "datasource": {
            "type": "marcusolsson-json-datasource",
            "uid": "${DS_JSON_API (CURRENCY)}"
          },
          "fields": [
            {
              "jsonPath": "$.LTCBRL.bid",
              "type": "number"
            }
          ],
          "method": "GET",
          "queryParams": "",
          "refId": "A",
          "urlPath": "/last/LTC-BRL"
        }
      ],
      "title": "Litecoin (compra)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "marcusolsson-json-datasource",
        "uid": "${DS_JSON_API (CURRENCY)}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 3,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "orange",
                "value": null
              },
              {
                "color": "green",
                "value": 1
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 3,
        "x": 15,
        "y": 98
      },
      "id": 31,
      "interval": "30s",
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "sum"
          ],
          "fields": "/^bid$/",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "cacheDurationSeconds": 300,
          "datasource": {
            "type": "marcusolsson-json-datasource",
            "uid": "${DS_JSON_API (CURRENCY)}"
          },
          "fields": [
            {
              "jsonPath": "$.DOGEBRL.bid",
              "type": "number"
            }
          ],
          "method": "GET",
          "queryParams": "",
          "refId": "A",
          "urlPath": "/last/DOGE-BRL"
        }
      ],
      "title": "Dogecoin (compra)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "marcusolsson-json-datasource",
        "uid": "${DS_JSON_API (CURRENCY)}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 3,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "purple",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 3,
        "x": 18,
        "y": 98
      },
      "id": 35,
      "interval": "30s",
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "sum"
          ],
          "fields": "/^bid$/",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "cacheDurationSeconds": 300,
          "datasource": {
            "type": "marcusolsson-json-datasource",
            "uid": "${DS_JSON_API (CURRENCY)}"
          },
          "fields": [
            {
              "jsonPath": "$.BTCBRL.bid",
              "type": "number"
            }
          ],
          "method": "GET",
          "queryParams": "",
          "refId": "A",
          "urlPath": "/last/BTC-BRL"
        }
      ],
      "title": "Bitcoin (compra)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "marcusolsson-json-datasource",
        "uid": "${DS_JSON_API (CURRENCY)}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 3,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "blue",
                "value": null
              }
            ]
          },
          "unit": "currencyBRL"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 3,
        "x": 21,
        "y": 98
      },
      "id": 33,
      "interval": "30s",
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "sum"
          ],
          "fields": "/^bid$/",
          "values": false
        },
        "textMode": "auto"
      },
      "pluginVersion": "8.4.3",
      "targets": [
        {
          "cacheDurationSeconds": 300,
          "datasource": {
            "type": "marcusolsson-json-datasource",
            "uid": "${DS_JSON_API (CURRENCY)}"
          },
          "fields": [
            {
              "jsonPath": "$.ETHBRL.bid",
              "type": "number"
            }
          ],
          "method": "GET",
          "queryParams": "",
          "refId": "A",
          "urlPath": "/last/ETH-BRL"
        }
      ],
      "title": "Ethereum (compra)",
      "type": "stat"
    }
  ],
  "refresh": "5m",
  "schemaVersion": 35,
  "style": "dark",
  "tags": [],
  "templating": {
    "list": [
      {
        "current": {},
        "definition": "select name from finance.category",
        "hide": 0,
        "includeAll": true,
        "multi": true,
        "name": "category",
        "options": [],
        "query": "select name from finance.category",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query",
        "datasource": "${DS_MYSQL}"
      },
      {
        "current": {},
        "datasource": {
          "type": "marcusolsson-json-datasource",
          "uid": "${DS_JSON_API (CURRENCY)}"
        },
        "definition": "$.USDBRL.bid",
        "hide": 0,
        "includeAll": false,
        "label": "dolar (R$)",
        "multi": false,
        "name": "dolar",
        "options": [],
        "query": {
          "cacheDurationSeconds": 300,
          "fields": [
            {
              "jsonPath": "$.USDBRL.bid"
            }
          ],
          "method": "GET",
          "queryParams": "",
          "urlPath": "/last/USD-BRL"
        },
        "refresh": 2,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      }
    ]
  },
  "time": {
    "from": "2022-03-02T19:36:59.941Z",
    "to": "2022-03-03T00:56:59.941Z"
  },
  "timepicker": {},
  "timezone": "",
  "title": "Finance",
  "uid": "u6pvSDYnk",
  "version": 128,
  "weekStart": ""
}
